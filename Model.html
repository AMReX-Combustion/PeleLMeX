<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The PeleLMeX Model &mdash; PeleLMeX 22.11 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="PeleLMeX Verification &amp; Validations" href="Validation.html" />
    <link rel="prev" title="Welcome to PeleLMeX’s documentation!" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> PeleLMeX
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">The <cite>PeleLMeX</cite> Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview-of-pelelmex">Overview of <cite>PeleLMeX</cite></a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-low-mach-number-flow-equations">The low Mach number flow equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#confined-domain-ambient-pressure">Confined domain ambient pressure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#geometry-with-embedded-boundaries">Geometry with Embedded Boundaries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="Validation.html">PeleLMeX Verification &amp; Validations</a></li>
<li class="toctree-l1"><a class="reference internal" href="LMeXControls.html">PeleLMeX controls</a></li>
<li class="toctree-l1"><a class="reference internal" href="Troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">PeleLMeX</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
      <li class="breadcrumb-item active">The <cite>PeleLMeX</cite> Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Model.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-pelelmex-model">
<span id="sec-model"></span><h1>The <cite>PeleLMeX</cite> Model<a class="headerlink" href="#the-pelelmex-model" title="Permalink to this heading"></a></h1>
<p>In this section, we present the actual model that is evolved numerically by <cite>PeleLMeX</cite>, and the numerical algorithms
to do it.  There are many control parameters to customize the solution strategy and process, and in order to actually
set up and run specific problems with <cite>PeleLMeX</cite>, the user must specific the chemical model, and provide routines
that implement initial and boundary data and refinement criteria for the adaptive mesh refinement.  We discuss
setup and control of <cite>PeleLMeX</cite> in later sections. <cite>PeleLMeX</cite> is a non-subcycling version of <cite>PeleLM</cite> and as such, much of the following is identical to the model in <cite>PeleLM</cite> with a few key differences.</p>
<section id="overview-of-pelelmex">
<h2>Overview of <cite>PeleLMeX</cite><a class="headerlink" href="#overview-of-pelelmex" title="Permalink to this heading"></a></h2>
<p><cite>PeleLMeX</cite> evolves chemically reacting low Mach number flows with block-structured adaptive mesh refinement (AMR). The code depends upon the <a class="reference external" href="https://github.com/AMReX-Codes/amrex">AMReX</a> library to provide the underlying data structures, and tools to manage and operate on them across massively parallel computing architectures. <cite>PeleLMeX</cite> also utilizes the source code and algorithmic infrastructure of <a class="reference external" href="https://github.com/AMReX-Codes/AMReX-Hydro">AMReX-Hydro</a>. <cite>PeleLMeX</cite> borrows heavily from <a class="reference external" href="https://github.com/AMReX-Combustion/PeleLM">PeleLM</a>. The core algorithms in <cite>PeleLM</cite> are described in the following papers:</p>
<ul class="simple">
<li><p><em>A conservative, thermodynamically consistent numerical approach for low Mach number combustion. I. Single-level integration</em>, A. Nonaka, J. B. Bell, and M. S. Day, <em>Combust. Theor. Model.</em>, <strong>22</strong> (1) 156-184 (2018)</p></li>
<li><p><em>A Deferred Correction Coupling Strategy for Low Mach Number Flow with Complex Chemistry</em>, A. Nonaka, J. B. Bell, M. S. Day, C. Gilet, A. S. Almgren, and M. L. Minion, <em>Combust. Theory and Model</em>, <strong>16</strong> (6) 1053-1088 (2012)</p></li>
<li><p><em>Numerical Simulation of Laminar Reacting Flows with Complex Chemistry</em>, M. S. Day and J. B. Bell, <em>Combust. Theory Model</em> <strong>4</strong> (4) 535-556 (2000)</p></li>
<li><p><em>An Adaptive Projection Method for Unsteady, Low-Mach Number Combustion</em>, R. B. Pember, L. H. Howell, J. B. Bell, P. Colella, W. Y. Crutchfield, W. A. Fiveland, and J. P. Jessee, <em>Comb. Sci. Tech.</em>, <strong>140</strong> 123-168 (1998)</p></li>
<li><p><em>A Conservative Adaptive Projection Method for the Variable Density Incompressible Navier-Stokes Equations,</em> A. S. Almgren, J. B. Bell, P. Colella, L. H. Howell, and M. L. Welcome, <em>J. Comp. Phys.</em>, <strong>142</strong> 1-46 (1998)</p></li>
</ul>
<section id="the-low-mach-number-flow-equations">
<h3>The low Mach number flow equations<a class="headerlink" href="#the-low-mach-number-flow-equations" title="Permalink to this heading"></a></h3>
<p><cite>PeleLMeX</cite> solves the reacting Navier-Stokes flow equations in the <em>low Mach number</em> regime, where the characteristic fluid velocity is small compared to the sound speed, and the effect of acoustic wave propagation is unimportant to the overall dynamics of the system. Accordingly, acoustic wave propagation can be mathematically removed from the equations of motion, allowing for a numerical time step based on an advective CFL condition, and this leads to an increase in the allowable time step of order <span class="math notranslate nohighlight">\(1/M\)</span> over an explicit, fully compressible method (<span class="math notranslate nohighlight">\(M\)</span> is the Mach number).  In this mathematical framework, the total pressure is decomposed into the sum of a spatially constant (ambient) thermodynamic pressure <span class="math notranslate nohighlight">\(P_0\)</span> and a perturbational pressure, <span class="math notranslate nohighlight">\(\pi({\vec x})\)</span> that drives the flow.  Under suitable conditions, <span class="math notranslate nohighlight">\(\pi/P_0 = \mathcal{O} (M^2)\)</span>.</p>
<p>The set of conservation equations specialized to the low Mach number regime is a system of PDEs with advection, diffusion and reaction (ADR) processes that are constrained to evolve on the manifold of a spatially constant <span class="math notranslate nohighlight">\(P_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\begin{split}&amp;\frac{\partial (\rho \boldsymbol{u})}{\partial t} +
\nabla \cdot \left(\rho  \boldsymbol{u} \boldsymbol{u} + \tau \right)
= -\nabla \pi + \rho \boldsymbol{F},\\
&amp;\frac{\partial (\rho Y_m)}{\partial t} +
\nabla \cdot \left( \rho Y_m \boldsymbol{u}
+ \boldsymbol{\mathcal{F}}_{m} \right)
= \rho \dot{\omega}_m,\\
&amp;\frac{ \partial (\rho h)}{ \partial t} +
\nabla \cdot \left( \rho h \boldsymbol{u}
+ \boldsymbol{\mathcal{Q}} \right) = 0 ,\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho\)</span> is the density, <span class="math notranslate nohighlight">\(\boldsymbol{u}\)</span> is the velocity, <span class="math notranslate nohighlight">\(h\)</span> is the mass-weighted enthalpy, <span class="math notranslate nohighlight">\(T\)</span> is temperature and <span class="math notranslate nohighlight">\(Y_m\)</span> is the mass fraction of species <span class="math notranslate nohighlight">\(m\)</span>. <span class="math notranslate nohighlight">\(\dot{\omega}_m\)</span> is the molar production rate for species <span class="math notranslate nohighlight">\(m\)</span>, the modeling of which will be described later in this section. <span class="math notranslate nohighlight">\(\tau\)</span> is the stress tensor, <span class="math notranslate nohighlight">\(\boldsymbol{\mathcal{Q}}\)</span> is the heat flux and <span class="math notranslate nohighlight">\(\boldsymbol{\mathcal{F}}_m\)</span> are the species diffusion fluxes. These transport fluxes require the evaluation of transport coefficients (e.g., the viscosity <span class="math notranslate nohighlight">\(\mu\)</span>, the conductivity <span class="math notranslate nohighlight">\(\lambda\)</span> and the diffusivity matrix <span class="math notranslate nohighlight">\(D\)</span>) which are computed using the library EGLIB, as will be described in more depth in the diffusion section. The momentum source, <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span>, is an external forcing term.  For example, we have used <span class="math notranslate nohighlight">\(\boldsymbol{F}\)</span> to implement a long-wavelength time-dependent force to establish and maintain quasi-stationary turbulence.</p>
<p>These evolution equations are supplemented by an equation of state for the thermodynamic pressure.  For example, the ideal gas law,</p>
<div class="math notranslate nohighlight">
\[P_0(\rho,Y_m,T)=\frac{\rho \mathcal{R} T}{W}=\rho \mathcal{R} T
\sum_m \frac{Y_m}{W_m} .\]</div>
<p>In the above, <span class="math notranslate nohighlight">\(W_m\)</span> and <span class="math notranslate nohighlight">\(W\)</span> are the species <span class="math notranslate nohighlight">\(m\)</span>, and mean molecular weights, respectively.  To close the system we also require a relationship between enthalpy, species and temperature.  We adopt the definition used in the CHEMKIN standard,</p>
<div class="math notranslate nohighlight">
\[h=\sum_m Y_m h_m(T)\]</div>
<p>where <span class="math notranslate nohighlight">\(h_m\)</span> is the species <span class="math notranslate nohighlight">\(m\)</span> enthalpy.  Note that expressions for <span class="math notranslate nohighlight">\(h_m(T)\)</span> see &lt;section on thermo properties&gt; incorporate the heat of formation for each species.</p>
<p>Neither species diffusion nor reactions redistribute the total mass, hence we have <span class="math notranslate nohighlight">\(\sum_m \boldsymbol{\mathcal{F}}_m = 0\)</span> and <span class="math notranslate nohighlight">\(\sum_m \dot{\omega}_m = 0\)</span>. Thus, summing the species equations and using the definition <span class="math notranslate nohighlight">\(\sum_m Y_m = 1\)</span> we obtain the continuity equation:</p>
<div class="math notranslate nohighlight">
\[\frac{\partial \rho}{\partial t} + \nabla \cdot \rho \boldsymbol{u} = 0\]</div>
<p>This, together with the conservation equations form a differential-algebraic equation (DAE) system that describes an evolution subject to a constraint.  A standard approach to attacking such a system computationally is to differentiate the constraint until it can be recast as an initial value problem.  Following this procedure, we set the thermodynamic pressure constant in the frame of the fluid,</p>
<div class="math notranslate nohighlight">
\[\frac{DP_0}{Dt} = 0\]</div>
<p>and observe that if the initial conditions satisfy the constraint, an evolution satisfying the above will continue to satisfy the constraint over all time.  Expanding this expression via the chain rule and continuity:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \boldsymbol{u} = \frac{1}{T}\frac{DT}{Dt}
+ W \sum_m \frac{1}{W_m} \frac{DY_m}{Dt} = S\]</div>
<p>The constraint here take the form of a condition on the divergence of the flow.  Note that the actual expressions to use here will depend upon the chosen models for evaluating the transport fluxes.</p>
<p>For the standard ideal gas EOS, the divergence constraint on velocity becomes:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\nabla \cdot \boldsymbol{u} &amp;= \frac{1}{\rho c_p T} \left(\nabla \cdot \lambda\nabla T - \sum_m \boldsymbol{\Gamma_m} \cdot \nabla h_m \right) \\
&amp;- \frac{1}{\rho} \sum_m \frac{W}{W_m} \nabla \cdot \boldsymbol{\Gamma_m} + \frac{1}{\rho}\sum_m \left(\frac{W}{W_m} - \frac{h_m}{c_p T} \right) \dot \omega \equiv S .\end{split}\]</div>
</section>
<section id="confined-domain-ambient-pressure">
<h3>Confined domain ambient pressure<a class="headerlink" href="#confined-domain-ambient-pressure" title="Permalink to this heading"></a></h3>
<p>In unconfined domains, the ambient pressure will remain constant in time, but for confined domains, this is not the case. Above, we assumed that <span class="math notranslate nohighlight">\(p_0\)</span> was constant. If <span class="math notranslate nohighlight">\(p_0\)</span> is a function of time, the pressure derivative term must be restored in the velocity divergence constraint as:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \boldsymbol{u} + \theta \frac{dp_0}{dt} = S ,\]</div>
<p>where <span class="math notranslate nohighlight">\(\theta \equiv 1/(\Gamma_1 p_0)\)</span>, with <span class="math notranslate nohighlight">\(\Gamma_1 = \partial ln(p)/\partial ln(\rho)|_s\)</span> being the first adiabatic exponent. <span class="math notranslate nohighlight">\(\Gamma_1\)</span> depends on the composition and is not a constant. Both <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(\S\)</span> can be decomposed into mean and fluctuating components and the above equation can be rewritten as:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \boldsymbol{u} + (\overline \theta + \delta \theta)\frac{dp_0}{dt} = \overline S + \delta S,\]</div>
<p>where <span class="math notranslate nohighlight">\(\overline \theta\)</span> and <span class="math notranslate nohighlight">\(\overline S\)</span> are the mean values of <span class="math notranslate nohighlight">\(\theta\)</span> and <span class="math notranslate nohighlight">\(S\)</span> over the domain, and <span class="math notranslate nohighlight">\(\delta \theta\)</span> and <span class="math notranslate nohighlight">\(\delta S\)</span> are the perturbations off their respective means that both integrate to zero over the domain, by definition. This equation can be simplified by integrating over the domain volume:</p>
<div class="math notranslate nohighlight">
\[\int_V \nabla \cdot \boldsymbol{u} dV + \int_V (\overline \theta + \delta \theta)\frac{dp_0}{dt} dV = \int_V (\overline S + \delta S) dV\]</div>
<p>Since the perturbations integrate to zero over the domain volume, the mean values are constants, and <span class="math notranslate nohighlight">\(p_0\)</span> is only a function of time, the above simplifies to:</p>
<div class="math notranslate nohighlight">
\[\frac{1}{V} \int_V \nabla \cdot \boldsymbol{u} dV + \overline \theta \frac{dp_0}{dt} = \overline S .\]</div>
<p>Solving for <span class="math notranslate nohighlight">\(dp_0/dt\)</span> yields an evolution equation of <span class="math notranslate nohighlight">\(p_0\)</span>:</p>
<div class="math notranslate nohighlight">
\[\frac{dp_0}{dt} = \frac{1}{\overline \theta} \left(\overline S - \frac{1}{V} \int_A \boldsymbol{u} dA \right) ,\]</div>
<p>where we have used the divergence theorem to convert the volume integral into a surface integral over the domain boundaries: <span class="math notranslate nohighlight">\(\int_V \nabla \cdot \boldsymbol{u} dV = \int_A \boldsymbol{u} dA\)</span>. The above pressure evolution is accomponied by a modified velocity constraint:</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \boldsymbol{u} = \delta S - \delta \theta \frac{\overline S}{\overline \theta} - \left(1 + \frac{\theta}{\overline \theta} \right) \frac{1}{V} \int_A \boldsymbol{u} dA\]</div>
<p>The above equations hold for any fully enclosed or partially enclosed domain where there can be mass flowing into or out of the domain, but the next flowrate is non-zero and therefore the pressure should be adjusted in time. In a perfectly enclosed domain, where there is no mass in or out of the system, <span class="math notranslate nohighlight">\(\int_A \boldsymbol{u} dA = 0\)</span> and the pressure evolution is simplified to:</p>
<div class="math notranslate nohighlight">
\[\frac{dp_0}{dt} = \frac{\overline S}{\overline \theta} ,\]</div>
<p>and simplified velocity constraint,</p>
<div class="math notranslate nohighlight">
\[\nabla \cdot \boldsymbol{u} = \delta S - \delta \theta \frac{\overline S}{\overline \theta} .\]</div>
</section>
</section>
<section id="geometry-with-embedded-boundaries">
<h2>Geometry with Embedded Boundaries<a class="headerlink" href="#geometry-with-embedded-boundaries" title="Permalink to this heading"></a></h2>
<p><cite>PeleLMeX</cite> relies on <a href="#id1"><span class="problematic" id="id2">`AMReX's implementation&lt;https://amrex-codes.github.io/amrex/docs_html/EB_Chapter.html&gt;`_</span></a> of
the Embedded Boundaries (EB) approach to represent geometrical objects. In this approach, the underlying computational
mesh is uniform and block-structured, but the boundary of the irregular-shaped computational domain conceptually cuts
through this mesh. Each cell in the mesh becomes labeled as regular, cut or covered, and the finite-volume
based discretization methods traditionally used in AMReX applications need to be modified to incorporate these cell shapes.
AMReX provides the necessary EB data structures, including volume and area fractions, surface normals and centroids,
as well as local connectivity information. The fluxes are then modified to account for the apperture opening between adjacent
cells and the additional EB-fluxes are included when constructing the cell flux divergences.</p>
<p>A common problem arising with EB is the presence of the small cut-cells which can either introduce undesirable constraint on
the explicit time step size or lead to numerical instabilities if not accounterd for. <cite>PeleLMeX</cite> relies on a combination of
classical flux redistribution (FRD) (Pember et al, 1995) and state redistribution (SRD) (Giuliani et al., 2022) to circumvent the issue.
In particular, explicit advective fluxes are treated using SRD while explicit diffusion fluxes (appearing in the SDC context)
are treated with FRD. Note that implicit diffusion fluxes are not redistributed as AMReX’s linear operators are EB-aware.</p>
<p>The use of AMReX’s multigrid linear solver introduces contraint on the complexity of the geometry <cite>PeleLMeX</cite> is able to handle. The
efficiency of the multigrid appraoch relies on generating coarse version of the linear problem. If the geometry includes thin elements
(such as tube or plate) or narrow channels, coarsening of the geometry is rapidly limited by the occurence of multi-cut cells (not
supported by AMReX) and the linear solvers are no longer able to robustly tackle projections and implicit diffusion solves. AMReX
include an interface to HYPRE which can help circumvent the issue by sending the coarse-level geometry directly to HYPRE algebraic
multigrid solvers. More details on how to use HYPRE is provided in control Section.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="Welcome to PeleLMeX’s documentation!" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Validation.html" class="btn btn-neutral float-right" title="PeleLMeX Verification &amp; Validations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021-2022, PeleTeam.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>